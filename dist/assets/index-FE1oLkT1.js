(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const Be="./images/apple-fritter.jpeg",Me="./images/chocholate.jpeg",je="./images/cookies&cream.jpeg",Oe="./images/cruller.jpeg",De="./images/halloween.jpeg",ze="./images/maple-bacon.jpeg",Ne="./images/matcha.jpeg",Ze="./images/peanutbutter-jelly.jpeg",Fe="./images/pumpkin-spice.jpeg",Ke="./images/smores.jpeg",Re="./images/strawberry.jpeg",i=[{id:0,name:"Apple-fritter",price:15,amount:0,image:Be,rating:3.5,category:"Klassiska smaker"},{id:1,name:"Chocholate",price:12,amount:0,image:Me,rating:3,category:"Klassiska smaker"},{id:2,name:"Cruller",price:15,amount:0,image:Oe,rating:4,category:"Klassiska smaker"},{id:3,name:"Halloween Special",price:18,amount:0,image:De,rating:3.5,category:"Unika smaker"},{id:4,name:"Maple Bacon",price:15,amount:0,image:ze,rating:3,category:"Klassiska smaker"},{id:5,name:"Matcha",price:15,amount:0,image:Ne,rating:4,category:"Unika smaker"},{id:6,name:"Peanut Butter & Jelly",price:15,amount:0,image:Ze,rating:4.5,category:"Unika smaker"},{id:7,name:"Pumpkin Spice",price:18,amount:0,image:Fe,rating:3,category:"Säsongs smaker"},{id:8,name:"Smores",price:18,amount:0,image:Ke,rating:3.5,category:"Säsongs smaker"},{id:9,name:"Cookies & Cream",price:18,amount:0,image:je,rating:4.5,category:"Unika smaker"},{id:10,name:"Strawberry",price:12,amount:0,image:Re,rating:3,category:"Klassiska smaker"}],Ue=()=>{document.querySelector(".theme-toggle").addEventListener("click",()=>{document.body.classList.toggle("dark-mode")})},Je=()=>{document.querySelector(".sort-rating").addEventListener("click",()=>{i.sort((r,n)=>n.rating-r.rating),M()}),document.querySelector(".sort-name").addEventListener("click",()=>{i.sort((r,n)=>r.name.localeCompare(n.name)),M()}),document.querySelector(".sort-category").addEventListener("click",()=>{i.sort((r,n)=>r.category.localeCompare(n.category)),M()}),document.querySelector(".sort-price").addEventListener("click",()=>{i.sort((r,n)=>r.price-n.price),M()})},_=document.querySelector("header"),ce=document.querySelector(".checkout"),Q=document.querySelector(".form"),C=document.querySelector(".form__name"),T=document.querySelector(".form__lastname"),j=document.querySelector(".form__street"),x=document.querySelector(".form__postcode"),O=document.querySelector(".form__doorcode"),I=document.querySelector(".form__city"),w=document.querySelector(".form__phone"),D=document.querySelector(".form__email"),ae=document.querySelector("input.form__payment-card"),b=document.querySelector("input.form__payment-invoice"),ne=document.querySelector(".form__person-id"),v=document.querySelector(".pers-id"),se=document.querySelector(".form__card"),Ge=document.querySelector(".form__reset"),Qe=document.querySelector(".checkout__total"),de=document.querySelector(".over-limit"),oe=document.querySelector(".form__hard-reset"),Ve=document.querySelector(".form__hard-reset-btn"),Xe=document.querySelector(".form__modal--close"),E=document.querySelector(".form__submit"),F=document.querySelector(".order-info"),Ye=document.querySelector("#success-sr"),qe=document.querySelector(".theme-toggle"),We=/^[A-Za-zÅÄÖåäö]{2,}$/,et=/^[A-Za-zÅÄÖåäö]{2,}$/,tt=/^[A-Za-zÅÄÖåäö\s-]+ [0-9]{1,5}[A-Za-z]?$/,rt=/^[0-9]{3}\s?[0-9]{2}$/,at=/^\d{3,10}$/,nt=/^[A-Za-zÅÄÖåäö]{2,}([- ]?[A-Za-zÅÄÖåäö]{2,})*$/,st=/^(?:\+46|0)(\d{1,3})[\s-]?(\d{3})[\s-]?(\d{4})$/,ot=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,it=/^\d{8}-?\d{4}$/;Q.addEventListener("submit",e=>{e.preventDefault()});const y=(e,t,s)=>{let a=s.exec(t);if(t!==""?a?a&&(e.classList.remove("invalid-input-border"),e.classList.add("input-border"),e.setAttribute("aria-invalid","false"),e.closest("label").querySelector(".inputError").innerHTML="Ok",e.closest("label").querySelector(".inputError").classList.remove("invalid-input-color"),e.closest("label").querySelector(".inputError").classList.add("valid-input-color"),e.dataset.valid="true"):(e.classList.remove("input-border"),e.classList.add("invalid-input-border"),e.setAttribute("aria-invalid","true"),e.closest("label").querySelector(".inputError").innerHTML="Ogiltig",e.closest("label").querySelector(".inputError").classList.remove("valid-input-color"),e.closest("label").querySelector(".inputError").classList.add("invalid-input-color"),e.dataset.valid="false"):t==""&&(e.classList.remove("invalid-input-border"),e.setAttribute("aria-invalid","false"),e.closest("label").querySelector(".inputError").innerHTML="",e.dataset.valid="false"),z(),a)return a[0].toString()};let $=[C,T,j,x,I,w,D],V;const le=document.querySelector("#nameError");C.addEventListener("input",e=>{e.target.value=e.target.value.replace(/[^A-Za-z\s]/g,"")});C.addEventListener("blur",e=>{const t=e.target.value.trim();V=y(e.target,t,We),t!==""&&!V?(le.textContent="Ange minst 2 bokstäver",C.setAttribute("aria-describedby","nameError")):(le.textContent="",C.removeAttribute("aria-describedby"))});let X;const ue=document.querySelector("#lastnameError");T.addEventListener("input",e=>{e.target.value=e.target.value.replace(/[^A-Za-z\s]/g,"")});T.addEventListener("blur",e=>{const t=e.target.value.trim();X=y(e.target,t,et),t!==""&&!X?(ue.textContent="Ange minst 2 bokstäver",T.setAttribute("aria-describedby","lastnameError")):(ue.textContent="",T.removeAttribute("aria-describedby"))});let Y;const me=document.querySelector("#streetError");j.addEventListener("blur",e=>{const t=e.target.value.trim();Y=y(e.target,t,tt),t!==""&&!Y?(me.textContent="Ange gatan",j.setAttribute("aria-describedby","streetError")):(me.textContent="",j.removeAttribute("aria-describedby"))});let W;const ge=document.querySelector("#postcodeError");x.addEventListener("input",e=>e.target.value=e.target.value.replace(/[^0-9\s]/g,""));x.addEventListener("blur",e=>{const t=e.target.value.trim();W=y(e.target,t,rt),t!==""&&!W?(ge.textContent="Ange postnummer med 5 siffror",x.setAttribute("aria-describedby","postcodeError")):(ge.textContent="",x.removeAttribute("aria-describedby"))});let ct;const pe=document.querySelector("#doorcodeError");O.addEventListener("input",e=>e.target.value=e.target.value.replace(/[^0-9\s]/g,""));O.addEventListener("blur",e=>{const t=e.target.value.trim();y(e.target,t,at),t!==""&&!ct?(pe.textContent="Ange portkod med 3 till 10 siffror",O.setAttribute("aria-describedby","doorcodeError")):(pe.textContent="",O.removeAttribute("aria-describedby"))});let ee;const fe=document.querySelector("#cityError");I.addEventListener("input",e=>{e.target.value=e.target.value.replace(/[^A-Za-z\s]/g,"")});I.addEventListener("blur",e=>{const t=e.target.value.trim();ee=y(e.target,t,nt),t!==""&&!ee?(fe.textContent="Ange stad",I.setAttribute("aria-describedby","cityError")):(fe.textContent="",I.removeAttribute("aria-describedby"))});let te;const ve=document.querySelector("#phoneError");w.addEventListener("input",e=>e.target.value=e.target.value.replace(/[^0-9\s]/g,""));w.addEventListener("blur",e=>{const t=e.target.value.trim();te=y(e.target,t,st),t!==""&&!te?(ve.textContent="Ange telefonnummer med minst 10 siffror",w.setAttribute("aria-describedby","phoneError")):(ve.textContent="",w.removeAttribute("aria-describedby"))});let re;const ye=document.querySelector("#emailError");D.addEventListener("blur",e=>{const t=e.target.value.trim();re=y(e.target,t,ot),t!==""&&!re?(ye.textContent="Ange en giltig epostadress",D.setAttribute("aria-describedby","emailError")):(ye.textContent="",D.removeAttribute("aria-describedby"))});let be;const he=document.querySelector("#identityError");v.addEventListener("input",e=>e.target.value=e.target.value.replace(/[^0-9\s-]/g,""));v.addEventListener("blur",e=>{const t=e.target.value.trim();be=y(e.target,t,it),t!==""&&!be?(he.textContent="Ange svenskt personnummer med 12 siffror",v.setAttribute("aria-describedby","identityError")):(he.textContent="",v.removeAttribute("aria-describedby"))});const z=()=>{b.checked?$.every(e=>e!==v)&&$.push(v):ae.checked&&($=$.filter(e=>e!==v)),$.every(e=>e.dataset.valid==="true")?(E.disabled=!1,E.style.backgroundColor="rgb(255, 119, 142)"):(E.disabled=!0,E.style.backgroundColor="gray",E.setAttribute("title","form not complete"))};ae.addEventListener("change",e=>{e.target.checked&&(v.required=!1,se.classList.remove("hide"),ne.classList.add("hide"),z())});b.addEventListener("change",e=>{e.target.checked&&(se.classList.add("hide"),ne.classList.remove("hide"),v.required=!0,v.setAttribute("aria-required","true"),z())});Ge.addEventListener("click",()=>{oe.showModal()});Xe.addEventListener("click",e=>{e.preventDefault(),oe.close()});const dt=()=>{const{sumToCheckout:e}=H();qe.classList.add("hide"),_.classList.add("hide"),ce.innerHTML="",u.forEach(r=>{let n=r.amount*r.price;n=Math.floor(n),ce.innerHTML+=`
        <div class="checkout__item flex font-bold justify-start items-center gap-3 full">
          <img class="checkout__image" src="${r.image}" alt="Bild på munk med ${r.name} smak" width="1024" height="1024>
          <span class="checkout__name">${r.name}</span>
          <span class="checkout__amount">x ${r.amount}</span>
          <span class="checkout__price" data-id="${r.id}">${n} kr</span>
        </div>
      `,document.querySelectorAll(".checkout__price").forEach(h=>{h.dataset.id==r.id&&r.amount>=10&&(h.style.color="red")})});const t=()=>{setTimeout(()=>{alert("Beställing tog för lång tid, formuläret har rensats."),location.reload()},9e5)};e>800?(b.disabled=!0,b.setAttribute("aria-disabled","true"),b.setAttribute("aria-describedby","overLimit"),de.classList.remove("hide"),se.classList.remove("hide"),ne.classList.add("hide"),ae.checked=!0):(b.setAttribute("aria-disabled","false"),b.disabled=!1,b.removeAttribute("aria-describedby"),de.classList.add("hide")),Qe.innerHTML=`
  <span class="checkout-price font-bold mt-3" >Produktkostnad: ${e-m} kr</span>
  <span class="font-bold">Fraktkostnad: ${m} kr</span>
  <span class="font-bold">Totalt: ${e} kr</span>
  `,t();const s=new Date,a=document.querySelector(".checkout-price");s.getDay()===1&&s.getHours()<10&&(a.textContent=`Produktkostnad efter 10% rabatt ${e-m} kr`,a.classList.add("discounted"))};let Le=!1;E.addEventListener("click",()=>{Ye.textContent="Order mottagen",F.showModal(),F.addEventListener("keydown",t=>{t.key==="Escape"&&t.preventDefault()}),Le=!0,F.innerHTML=`
  <h2>Tack för beställningen!</h2>
  <span>Leveranstid 30-45 minuter</span>
  <div class="flex flex-col items-center" >
    <h3>Beställarens info:</h3>
    <span>${V.toLowerCase()} ${X.toLowerCase()}</span>
    <span>${Y.toLowerCase()}</span>
    <span>${W} ${ee.toLowerCase()}</span>
    <span>${te}</span>
    <span>${re}</span>
  </div>
  <button class="form__submitted form__button" aria-label="Återgå till sidans start">Ok</button>
  `;const e=document.querySelector(".form__submitted");Le===!0&&e.addEventListener("click",()=>{location.href="index.html"})});Ve.addEventListener("click",()=>{qe.classList.remove("hide"),Q.reset(),Q.querySelectorAll("input").forEach(e=>{e.removeAttribute("aria-describedby"),e.removeAttribute("aria-invalid"),e.removeAttribute("data-valid"),e.style.border="1px solid rgb(255, 119, 142)",document.querySelectorAll(".inputError").forEach(t=>t.innerHTML="")}),gt(),oe.close(),f.classList.add("hide")});const Ae=1024,$e=1024,ke=document.querySelector("#products"),K=document.querySelector(".cart"),o=document.querySelector(".cart-modal"),Ee=document.querySelector(".cart-products"),P=document.querySelector(".cart-total-price"),R=document.querySelector(".cart-close-btn"),U=document.querySelector(".cart-sub-btn"),Se=document.querySelector(".discount-info"),k=document.querySelector(".shipping-cost"),B=document.querySelector(".product-cost"),J=document.querySelector(".form__close"),L=document.querySelector("footer"),_e=document.querySelector(".cart-amount"),d=document.querySelector(".total-price"),g=document.querySelector(".main__info"),p=document.querySelector(".product-wrap"),S=document.querySelector(".theme-toggle"),f=document.querySelector("#order-summary");Ue();let c=[],u=[],m=0,G;const lt=()=>{const e=new Date;(e.getDay()===5&&e.getHours()>15||e.getDay()===6||e.getDay()===0||e.getDay()===1&&e.getHours()<3)&&i.forEach(t=>{t.price=Math.ceil(t.price*1.15)})};lt();const Ce=e=>{let t="";for(let s=0;s<Math.floor(e);s++)t+='<i class="fa fa-star" aria-hidden="true"></i>';return e.toString().includes(".")&&(t+='<i class="fa fa-star-half-alt" aria-hidden="true"></i>'),t},Te=e=>{S==null||S.classList.remove("hide"),ke.innerHTML="",e.forEach(t=>{ke.innerHTML+=`
    <article class="product" data-id=${t.id}>
        <img class="product__image" src="${t.image}" alt="Bild på munk med ${t.name} smak" width=${Ae} height=${$e}>
        <div class="product-wrap">
          <h3 class="product-info">
            <span class="product-name">${t.name}</span>
            <span class="product-price">Pris: ${t.price} kr</span>
            <div role="img" class="product-rating" aria-label="Kundomdöme ${t.rating} stjärnor">${Ce(t.rating)}</div>
          </h3>
        <div class="amount justify-center">
          <button class="decrease-btn" aria-label="minska antal" data-id=${t.id}>-</button>
          <input class="amount-input main amount-${t.id}" aria-label="produkt antal" data-id=${t.id}  type="number" value=${t.amount} min="0"></input>
          <button class="increase-btn" aria-label="öka antal" data-id=${t.id}>+</button>
        </div>
        </div>
    </article>`})};Te(i);const xe=()=>{document.querySelectorAll(".decrease-btn").forEach(s=>s.addEventListener("click",a=>Ie(a))),document.querySelectorAll(".increase-btn").forEach(s=>s.addEventListener("click",a=>we(a)))};xe();const M=()=>{Te(i),q("main","id"),ie(),xe()};Je();u=c.map(e=>({...e}));const Ie=e=>{const t=e.target,s=parseInt(t==null?void 0:t.dataset.id),a=i.findIndex(r=>r.id==s);a!=-1&&(i[a].amount==1&&!(o!=null&&o.open)&&(u=[...u.filter(n=>n.id!=s)]),i[a].amount!=0&&(o!=null&&o.open&&i[a].amount==1||(i[a].amount-=1,i[a].amount==0&&(e.target,c=[...c.filter(n=>n.id!=s)]),document.querySelector(`.amount-${s}`).value=i[a].amount.toString(),H(),N(),o!=null&&o.open&&Pe(s,i[a].amount),d==null||d.classList.add("scale"),setTimeout(()=>d==null?void 0:d.classList.remove("scale"),500))))},we=e=>{const t=e.target,s=parseInt(t==null?void 0:t.dataset.id),a=i.findIndex(r=>r.id==s);a!=-1&&(i[a].amount+=1,c.some(r=>r.id==parseInt(t==null?void 0:t.dataset.id))||c.push(i[a]),u.some(r=>r.id==parseInt(t==null?void 0:t.dataset.id))||u.push({...i[a]}),document.querySelector(`.amount-${s}`).value=i[a].amount.toString(),H(),N(),o!=null&&o.open&&Pe(s,i[a].amount),d==null||d.classList.add("scale"),setTimeout(()=>d==null?void 0:d.classList.remove("scale"),500))};K==null||K.addEventListener("click",()=>{c.length!==0&&(He(),o==null||o.showModal(),q("cart-amount-input","cartId"))});const ut=()=>{document.querySelectorAll(".cart-decrease-btn").forEach(a=>a.addEventListener("click",r=>Ie(r))),document.querySelectorAll(".cart-increase-btn").forEach(a=>a.addEventListener("click",r=>we(r))),document.querySelectorAll(".cart-remove-btn").forEach(a=>a.addEventListener("click",r=>mt(r))),R==null||R.addEventListener("click",()=>{o==null||o.close(),g==null||g.classList.remove("hide"),p==null||p.classList.remove("hide")}),U==null||U.addEventListener("click",()=>{g==null||g.classList.add("hide"),p==null||p.classList.add("hide"),o==null||o.close(),dt(),z(),f==null||f.classList.remove("hide"),f==null||f.scrollIntoView(),L==null||L.classList.add("hide")})};J==null||J.addEventListener("click",()=>{S==null||S.classList.remove("hide"),g==null||g.classList.remove("hide"),p==null||p.classList.remove("hide"),o==null||o.showModal(),f==null||f.classList.add("hide"),_==null||_.classList.remove("hide"),L==null||L.classList.remove("hide")});const He=()=>{Ee.innerHTML="",c.forEach(e=>{Ee.innerHTML+=`
        <div class="cart-items">
          <img class="cart-image" src="${e.image}" alt="Bild på munk med ${e.name} smak" width=${Ae} height=${$e}>
          <h3 class="cart-product-info" >
            <span class="product-name" >${e.name}</span>
            <span class="product-price" >Pris: ${e.price} kr</span>
            <span class="product-rating" aria-label="Kundomdöme ${e.rating} stjärnor">${Ce(e.rating)}</span>
          </h3>
          <div class="amount cart-amount-div flex justify-between">
            <button class="cart-decrease-btn" aria-label="minska antal" data-id=${e.id}>-</button>
            <input class="amount-input cart-amount-input" type="number" data-cart-id=${e.id}  value=${e.amount} min="0"></input>
            <button class="cart-increase-btn" aria-label="öka antal" data-id=${e.id}>+</button>
            <button class="cart-remove-btn" data-id=${e.id}>Ta bort</button>
          </div>
        </div>
        `}),ut(),q("main","id"),ie()},Pe=(e,t)=>{const s=document.querySelector(`[data-cart-id="${e}"]`);s.value=t.toString()},ie=()=>{document.querySelectorAll(".amount-input").forEach(t=>{t.addEventListener("input",()=>{t.value=t.value.replace(/[^0-9]/g,"")})})};ie();const H=()=>{u.forEach(a=>{const r=c.find(n=>n.id===a.id);if(r){a.amount=r.amount;const n=r.price,l=n*.9;r.amount>=10?a.price=l:r.amount<10&&(a.price=n)}});const e=Math.ceil(u.reduce((a,r)=>a+r.price*r.amount,0));c.reduce((a,r)=>a+r.amount,0)>=15?(m=0,k&&(k.innerHTML="Du har uppnått gratis frakt",k.classList.add("free-shipping"))):(m=Math.ceil(25+e*.1),k&&(k.innerHTML=`Fraktkostnad: ${m} kr`,k.classList.remove("free-shipping"))),d&&B&&(d.innerHTML=`Totalt: ${e} kr`,B.innerHTML=`Produktkostnad: ${e} kr`);const s=new Date;if(s.getDay()===1&&s.getHours()<10){const a=Math.floor(e*.9);let r=Math.ceil(e*.1);Se&&(Se.innerHTML=`<span class="discount">Måndagsrabatt: 10 % på hela beställningen</span>
    <span class="discount">Du sparar ${r} kr </span>`),P&&(P.innerHTML=`Totalt: ${a+m} kr`),G=a+m,B&&(B.innerHTML=`Produktkostnad: ${a} kr`)}else P&&(P.innerHTML=`Totalt: ${e+m} kr`),G=e+m;return{sumToCheckout:G}},q=(e,t)=>{const s=document.querySelectorAll(`.${e}`),a=r=>{i.forEach(n=>{const l=r.target;if(Number(l.dataset[t])==n.id){Number(l.value)<=0&&(o!=null&&o.open)&&(l.value=String(1)),n.amount=Number(l.value);const h=document.querySelector(`.amount-${n.id}`);h&&(parseFloat(h.value),n.amount),r.target.value>0&&(c.some(A=>A.id==r.target.dataset[t])||c.push(n),u.some(A=>A.id==r.target.dataset[t])||u.push({...n})),r.target.value==0&&(c=[...c.filter(Z=>Z.id!=r.target.dataset[t])],u=c.map(Z=>({...Z})))}}),H(),N(),d.classList.add("scale"),setTimeout(()=>d.classList.remove("scale"),500)};s.forEach(r=>{r.addEventListener("keyup",n=>{if(n.key==="Enter"){const l=Array.from(document.querySelectorAll("input, button")),h=l.indexOf(n.target);l[h+1].focus(),a(n)}}),r.addEventListener("blur",a)})};q("main","id");const N=()=>{let e=c.reduce((t,s)=>t+s.amount,0);_e.innerHTML=e},mt=e=>{const t=c.filter(a=>a.id!=e.target.dataset.id),s=c.find(a=>a.id==e.target.dataset.id);c=[...t],c.length==0&&o.close(),u=c.map(a=>({...a})),He(),H(),N(),q("cart-amount-input","cartId"),i.forEach(a=>{document.querySelector(`.amount-${e.target.dataset.id}`).value=a.amount,a.id==s.id&&(a.amount=0)})},gt=()=>{c.length=0,u.length=0,i.forEach(t=>t.amount=0),d.innerHTML="Totalt: 0 kr",_e.innerHTML=0,q("main","id"),document.querySelectorAll(".main").forEach(t=>t.value=0),L.classList.remove("hide"),g.classList.remove("hide"),p.classList.remove("hide"),_.classList.remove("hide"),window.scrollTo({top:0,behavior:"smooth"})};
